// This file was auto-generated by Fern from our API Definition.

import * as core from "../core/index.js";
import * as errors from "../errors/index.js";

export namespace BearerAuthProvider {
    export interface Options {
        token: core.EndpointSupplier<core.BearerToken>;
    }
}

export class BearerAuthProvider implements core.AuthProvider {
    private readonly token: core.EndpointSupplier<core.BearerToken>;

    constructor(options: BearerAuthProvider.Options) {
        this.token = options.token;
    }

    public static canCreate(options: BearerAuthProvider.Options): boolean {
        return options.token != null;
    }

    public async getAuthRequest(arg?: { endpointMetadata?: core.EndpointMetadata }): Promise<core.AuthRequest> {
        const token = await core.EndpointSupplier.get(this.token, { endpointMetadata: arg?.endpointMetadata ?? {} });
        if (token == null) {
            throw new errors.ManagementError({
                message: "Please specify a token by passing it in to the constructor",
            });
        }

        return {
            headers: { Authorization: `Bearer ${token}` },
        };
    }
}
